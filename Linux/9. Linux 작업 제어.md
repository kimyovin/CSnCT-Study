Linux 작업 제어
============================

### 작업 제어 도구(job control)

- 사용자가 한 프로세스를 실행하면서 동시에 다른 프로세스를 실행해야 할 때 사용한다.
- 한 터미널에서 동시에 여러 프로세스를 실행하고 관리한다.
- 작업 제어 도구가 관리하는 프로세스들을 **작업(jobs)**이라고 한다.

### 포그라운드 작업(foreground)

- 사용자의 명령을 실행하는 방식, 프롬프트가 출력되지 않아 결과 출력까지 다른 명령을 입력할 수 없다.
- 사용자가 입력한 명령이 실행되어 결과가 출력될 때까지 기다려야 하는 포그라운드 방식으로 처리되는 프로세스이다.
- 명령을 한 번에 하나씩 실행한다.

```bash
#주어진 시간만큼 sleep 명령이 끝나길 기다리는 명령
sleep 100
```

### 백그라운드 작업(backfround)]

- 작업 제어가 제공하는 백그라운드 기능을 사용하여 포그라운드 프로세스가 실행되는 동안 다른 백그라운드 프로세스가 실행된다.
- 한 터미널에서 여러 개의 프로세스를 동시에 실행할 수 있는 백그라운드 방식으로 처리되는 프로세스이다.
- 명령의 실행 시간이 많이 걸릴 것으로 예상되거나 명령을 실행한 후 다른 작업을 할 필요가 있을 때 많이 사용한다.
- 명령의 마지막에 ＆(앰퍼샌드) 기호를 추가한다.

```bash
#sleep 명령 백그라운드 작업
sleep 100 &
```

- 백그라운드 작업과 출력 방향 전환
- 출력과 오류 방향을 전환하여 실행 결과와 오류 메시지를 파일로 저장하는 방법
- 백그라운드 작업 결과와 포그라운드 작업 결과 뒤섞임을 방지

```bash
#pw.dat에 결과를 저장하는 명령
find / -name passwd > pw.dat &
```

### 작업 제어

1. 작업 전환
- 포그라운드 작업을 백그라운드 작업으로 전환, 백그라운드 작업을 포그라운드 작업으로 전환
2. 작업 일시 중지
- 작업을 잠시 중단
3. 작업 종료

#### 작업 목록 보기 : `jobs`

- 백그라운드 작업을 모두 보여줌
- `jobs [%작업번호]`
    - %번호 : 해당 번호의 작업 정보 출력
    - %+, %% : 작업 순서가 +인 작업 정보 출력
    - %- : 작업 순서가 -인 작업 정보 출력
- 출력 항목
    - 작업 번호: 백그라운드 실행순으로 숫자가 순차적으로 증가
    - 작업 순서
        - + : 가장 최근에 접근한 작업
        - - : + 작업보다 바로 전에 접근한 작업
        - 공백 : 그 외의 작업
    - 상태 : 작업의 상태를 나타냄
        - Running: 현재 실행 중
        - Done: 작업 정상 종료됨
        - Terminated: 작업 비정상 종료됨
        - Stopped: 작업 잠시 중단
    - 명령: 백그라운드로 실행 중인 명령

```bash
jobs
```

#### 작업 전환

- `Ctrl+z`, `stop [%작업번호]` : 포그라운드 작업 잠시 중지
- `bg [%작업 번호]` : 백그라운드 작업으로 전환
- `fg [%작업 번호]` : 포그라운드 작업으로 전환

```bash
jobs
sleep 100
^z
bg %1
jobs

jobs
fg
```

#### 작업 종료 : `Ctrl+c`

- 포그라운드 작업은 대부분 `Ctrl+c` 로 종료됨
- 백그라운드 작업은 `kill PID`, `kill %작업번호` 로 강제 종료함

#### `nohup`

- 로그아웃한 뒤에도 백그라운드 작업 실행
- nohup 명령 &

```bash
nohup find / -name passwd ＆
```
