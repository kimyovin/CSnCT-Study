# TDD: Test-Driven Development

> 테스트 코드 작성 → 구현 코드 작성 → 리팩토링 단계를 짧은 주기로 반복하여 개발하는 '**테스트 주도 개발 방법론**'

- 소프트웨어 개발 방법론
- **테스트 코드를 먼저 작성**함으로써 **테스트 코드가 개발을 주도**함
- 실패를 포함하는 테스트코드의 작성이 앞서야 함
- 작성된 테스트 코드를 통과할 수 있는 **최소한의 구현 코드** 작성
- 최소한의 구현 코드를 리팩토링 단계에서 개선
- 테스트 코드 작성, 최소한의 구현 코드 작성, 구현 코드에 대한 리팩토링 순으로 **짧은 주기를 반복**하며 **점증적으로 개발**

## 장점

- 단기적인 목표와 장기적인 목표를 뚜렷하게 제시해주고 올바르게 잡아줌
- 반복되는 짧은 개발 패턴을 통해 개발 리듬을 만듦으로써 개발 집중력을 높여 줌
- 테스트 코드는 사용설명서 혹은 API 문서로서 의사소통의 도구로 활용 가능
- 개발하고 있는 코드의 문제점을 빠르게 잡아낼 수 있음
- 성취감은 개발자의 개발 능률을 크게 향상시킴
- 테스트코드를 먼저 작성하게 되면 개발해야하는 것에 대한 목적과 요소들을 좀 더 **명확화**할 수 있기 때문에, 구현체 코드를 작성할 때의 고민 시간 감소
- 테스트코드를 작성하기 어렵다는 것은 설계가 잘못되었다는 것을 암시함
- 코드 수정에 대한 불안감을 떨쳐버리고 즉각적으로 확신을 얻을 수 있게 해줌
- TDD 를 적용하게 되면 일정수준까지는 테스트 코드를 추가로 작성하는 부담때문에 비용이 증가하겠지만, 일정 시간 이후부터는 거의 비용이 증가하지 않고 일정하게 유지
- 구현보다는 **인터페이스에 집중**하게 해줌
- 객체가 어떻게 만들어졌는지 책임을 어떤 방식으로 수행하는지 보다는, **객체가 무슨 역할을 가져야 하는지** 그리고 이러한 역할을 위해 무엇을 노출해야하는지 등에 집중 가능

## Mock

- **테스트 코드를 작성**해야 하는데 **필요한 모듈이 완성되지 않은 상황**에서 Mock 객체 이용 가능
- Mock 객체는 행위에 대한 기능 검증을 재빠르게 수행할 때는 도움이 되지만, 너무 남용하게 되면 테스트 코드 자체의 가치를 깨뜨릴 수 있음

### Mock 객체 생성 방법

1. 테스트에 필요한 상태를 담고 있는 클래스를 직접 구현하여 인스턴스를 생성하는 방법
2. ‘Mockito’ 같은 Mock 프레임워크를 사용하는 방법

### private 메소드

- 테스트를 해야 한다는 느낌을 받을 정도로 중요한 역할을 담당하고 있다면, public 으로 이를 변경하거나 새로운 클래스를 하나 생성해 역할을 분리하고 공개할 필요는 없는지 고민해야 함
- private 메소드를 테스팅한다는 것은 다른 클래스로 이동해야 한다는 조짐일 수도 있음
- private 메소드에 대한 테스트 코드를 작성할 것인가 말 것인가에 대한 가장 간단한 해답은 '**그냥 하지 않는 것**'
- 반드시 테스트를 해야하는데 private 을 포기할 수 없는 경우라면, 우리는 대부분의 경우에 public 메소드를 통해 private 메소드를 간접적으로 테스트 가능

## 사용 원칙

1. **Top-Down 으로 방향**을 잡고, **Bottom-Up 으로 구현**에 집중하자
    - Top-Down 방식으로 설계 및 시나리오를 잡고, Bottom-Up 으로 기능에 대한 코드 구현을 구체화시키면서 문제점을 차례차례 해결
    - 디자인은 Top-Down 으로, 기능은 Bottom-Up
2. **바보 단계** 거치기
    - 처음부터 완벽한 코드를 작성하려고 한다면 개발 속도에도 저하가 발생하며 개발자의 정신건강에도 좋지 않음
    - 일단 클라이언트 관점에서 기대하는 바를 충족시킬 수 있도록 빠르게 구현한 후, 테스트 케이스가 깨지지 않는지 확인하며 리팩토링
3. **시나리오 구상**하기
    - Given / When / Then 템플릿을 통해 기대 행위에 대한 명세화에 초점을 맞춤
    - 기대 행위에 초점을 맞춰서 생각하면 테스트 메소드 각각의 시나리오를 작성하는 것이 한결 수월해짐
4. TDD의 단위 테스트를 **문서화**하자
    - 테스트 코드는 항상 거의 최신을 유지할 가능성이 높으며, 테스트 코드 자체가 메소드에 대한 사용법이나 예외 등을 담고 있으므로 좋은 샘플 코드로서도 가치가 있음
    - 일반적으로 테스트 코드는 메소드 당 작성되기 때문에 해당 메소드에 대한 예외 상황을 파악하기 쉬움
    - Given / When / Then 구조의 코드를 통해 테스트 코드를 읽는 것만으로 별다른 노력없이 의존성이 파악되는 경우가 많음

## 면접 질문

1. TDD가 무엇인가요?
2. TDD에 대해 어떻게 생각하시나요?
3. TDD의 장단점

#### 참고

- [cloudrain21.com/test-driven-development](http://cloudrain21.com/test-driven-development)
